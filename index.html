<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOHSIN ESTATE - KDA Employment Society Korangi Properties</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <style>
        /* Base Styles from index.html */
        :root {
            --primary-color: #0a2d4d; /* Deep Blue */
            --secondary-color: #d4af37; /* Gold Accent */
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
        }

        body {
            font-family: 'Poppins', sans-serif;
            scroll-behavior: smooth;
            background-color: #f0f2f5;
        }

        .ad-container-top-bottom { text-align: center; padding: 10px 0; background-color: #fff; }
        .ad-container-side { position: fixed; top: 100px; width: 160px; height: 300px; z-index: 1000; }
        .ad-left { left: 20px; }
        .ad-right { right: 20px; }
        
        @media (max-width: 1400px) { .ad-container-side { display: none; } }

        .navbar { background: linear-gradient(to right, rgba(10, 45, 77, 0.95), rgba(8, 36, 62, 0.9)); backdrop-filter: blur(10px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .navbar-brand { font-family: 'Playfair Display', serif; font-size: 1.8rem; color: var(--secondary-color) !important; }
        .nav-link { color: #ffffff; font-weight: 500; transition: color 0.3s ease; }
        .nav-link:hover, .nav-link.active { color: var(--secondary-color); }

        .hero-section { position: relative; min-height: 100vh; display: flex; align-items: center; color: white; overflow: hidden; }
        #hero-video { position: absolute; top: 50%; left: 50%; min-width: 100%; min-height: 100%; width: auto; height: auto; z-index: -2; transform: translateX(-50%) translateY(-50%); object-fit: cover; }
        .hero-section::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); z-index: -1; }
        .hero-content h1 { font-family: 'Playfair Display', serif; font-size: 2.5rem; text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7); }
        .hero-content p { text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.6); font-size: 1.1rem; }

        @media (min-width: 768px) { .hero-content h1 { font-size: 4rem; } }

        .ticker-wrap { background-color: var(--secondary-color); padding: 12px 0; overflow: hidden; white-space: nowrap; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .ticker-move { display: inline-block; animation: ticker 40s linear infinite; }
        .ticker-item { display: inline-block; color: var(--primary-color); font-weight: 600; padding: 0 2.5rem; font-size: 1rem; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        .section { padding: 80px 0; }
        .section-title { font-family: 'Playfair Display', serif; color: var(--primary-color); margin-bottom: 1rem; font-weight: 700; }

        .property-card { background-color: #fff; border: none; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 25px rgba(0,0,0,0.08); transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .property-card:hover { transform: translateY(-8px); box-shadow: 0 12px 30px rgba(0,0,0,0.12); }
        .property-media-container { position: relative; }
        .property-badge { position: absolute; top: 15px; left: 15px; background-color: var(--primary-color); color: white; padding: 6px 12px; border-radius: 50px; font-size: 0.9rem; font-weight: 500; z-index: 10; }
        .property-content { padding: 25px; }
        .property-price { font-size: 1.6rem; font-weight: 700; color: var(--secondary-color); margin-top: 10px; }
        .card-carousel-item img { height: 250px; object-fit: cover; width: 100%; }
        .card-video { width: 100%; height: auto; display: block; margin-top: -5px; } /* Added margin-top to prevent gap */

        .construction-table { box-shadow: 0 8px 25px rgba(0,0,0,0.08); border-radius: 15px; overflow: hidden; border: none; }

        .team-card { text-align: center; padding: 30px; background: #fff; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .team-card:hover { transform: translateY(-8px); box-shadow: 0 12px 30px rgba(0,0,0,0.12); }
        .team-avatar { font-size: 3.5rem; color: var(--primary-color); margin-bottom: 1rem; }
        .team-role { color: var(--secondary-color); font-weight: 600; }

        .contact-info-card { background: linear-gradient(135deg, var(--primary-color) 0%, #08243e 100%); color: white; padding: 40px; border-radius: 15px; box-shadow: 0 8px 25px rgba(10, 45, 77, 0.3); }
        .contact-info-card a { color: var(--secondary-color); transition: color 0.3s ease; }
        .contact-info-card a:hover { color: #fff; }

        .footer { background-color: var(--dark-gray); color: white; }
        .footer-links a { color: #ccc; text-decoration: none; transition: color 0.3s; }
        .footer-links a:hover { color: var(--secondary-color); }

        .btn { border-radius: 50px; font-weight: 600; padding: 10px 25px; transition: all 0.3s ease; }
        .btn-primary { background-color: var(--primary-color); border-color: var(--primary-color); }
        .btn-primary:hover { background-color: #08243e; border-color: #08243e; transform: translateY(-2px); }
        .btn-secondary { background-color: var(--secondary-color); border-color: var(--secondary-color); color: var(--primary-color) !important; }
        .btn-secondary:hover { background-color: #b8952d; border-color: #b8952d; transform: translateY(-2px); }
        
        /* Modal Styles */
        .modal-carousel-item img { height: 450px; object-fit: cover; width: 100%; border-radius: .3rem; }
        #property-video-player { max-width: 100%; max-height: 450px; background-color: #000; border-radius: .3rem;}
        .modal-property-info { display: flex; justify-content: space-around; text-align: center; border-top: 1px solid #dee2e6; border-bottom: 1px solid #dee2e6; padding: 1rem 0; margin: 1rem 0;}
        
        /* Styles from admin.html */
        #initial-view {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .btn-portal {
            font-size: 1.5rem;
            padding: 1rem 2rem;
            margin: 1rem;
        }
        .image-preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        .preview-image-wrapper {
            position: relative;
        }
        .preview-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border: 1px solid #ddd;
            border-radius: .25rem;
        }
        .remove-image-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            line-height: 20px;
            text-align: center;
            cursor: pointer;
            padding: 0;
        }
         .preview-video {
            width: 100%;
            max-height: 200px;
            border-radius: 5px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    
    <!-- Main Website View Wrapper -->
    <div id="main-view-wrapper">
        <!-- Left Side Ad -->
        <div class="ad-container-side ad-left">
            <script type="text/javascript"> atOptions = {'key' : 'ab57a227bcc4369acc8659d06593e497', 'format' : 'iframe', 'height' : 300, 'width' : 160, 'params' : {} }; </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/ab57a227bcc4369acc8659d06593e497/invoke.js"></script>
        </div>

        <!-- Right Side Ad -->
        <div class="ad-container-side ad-right">
            <script type="text/javascript"> atOptions = {'key' : 'ab57a227bcc4369acc8659d06593e497', 'format' : 'iframe', 'height' : 300, 'width' : 160, 'params' : {} }; </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/ab57a227bcc4369acc8659d06593e497/invoke.js"></script>
        </div>

        <!-- NAVIGATION BAR -->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
            <div class="container">
                <a class="navbar-brand" href="#home"><i class="fas fa-building-user me-2"></i>MOHSIN ESTATE</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="#properties">Properties</a></li>
                        <li class="nav-item"><a class="nav-link" href="#constructions">Constructions</a></li>
                        <li class="nav-item"><a class="nav-link" href="#team">About Us</a></li>
                        <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
                        <li class="nav-item ms-lg-2 mt-2 mt-lg-0"><a class="nav-link btn btn-secondary text-white px-3 py-2" href="https://wa.me/923362842584" target="_blank" style="line-height: 1;"><i class="fab fa-whatsapp me-1"></i>WhatsApp</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- HERO SECTION -->
        <section id="home" class="hero-section">
            <video id="hero-video" poster="https://images.unsplash.com/photo-1582407947304-fd86f028f716?q=80&w=1992&auto=format&fit=crop" autoplay loop muted playsinline>
                <source src="https://storage.googleapis.com/generativeai_demo_data/4427211-hd_1920_1080_25fps.mp4" type="video/mp4">
            </video>
            <div class="container text-center">
                <div class="hero-content">
                    <h1 class="display-3 fw-bold mb-4">Your Premier Real Estate Partner in KDA Korangi</h1>
                    <p class="lead mb-5">Discover exceptional properties for sale and rent, and build your dream home with our expert construction services.</p>
                    <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                        <a href="#properties" class="btn btn-secondary btn-lg">Explore Properties</a>
                        <a href="#contact" class="btn btn-outline-light btn-lg">Get In Touch</a>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- TICKER SECTION -->
        <div class="ticker-wrap">
            <div class="ticker-move">
                <div class="ticker-item">For Sale: 240 Sq. Yd. House in Sector 31-B</div>
                <div class="ticker-item">For Rent: 120 Sq. Yd. Upper Portion in Allahwala Town</div>
                <div class="ticker-item">New Construction Project Started in Sector 32-A</div>
                <div class="ticker-item">For Sale: 80 Sq. Yd. Corner House</div>
                <div class="ticker-item">Contact us for construction rates!</div>
            </div>
        </div>

        <!-- Top Inline Ad -->
        <div class="ad-container-top-bottom">
            <script type="text/javascript"> atOptions = {'key' : 'bbb39fa2df38b4031f13f19c6a9db940', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} }; </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/bbb39fa2df38b4031f13f19c6a9db940/invoke.js"></script>
        </div>

        <!-- PROPERTIES SECTION -->
        <section id="properties" class="section">
            <div class="container">
                <div class="text-center mb-5 position-relative">
                    <h2 class="section-title">Featured Properties</h2>
                    <p class="text-muted fs-5">A selection of premium homes available in KDA Employment Society, Korangi.</p>
                    <a href="javascript:void(0);" onclick="showAdminPanel()" class="btn btn-primary btn-sm position-absolute d-none d-md-inline-block" style="top: 0; right: 0;"><i class="fas fa-plus me-1"></i> Add Property</a>
                    <div class="d-md-none mt-3"><a href="javascript:void(0);" onclick="showAdminPanel()" class="btn btn-primary btn-sm"><i class="fas fa-plus me-1"></i> Add Property</a></div>
                </div>
                <div id="property-listings" class="row g-4 justify-content-center">
                    <!-- Property cards will be dynamically injected here -->
                </div>
            </div>
        </section>

        <!-- CONSTRUCTIONS SECTION -->
        <section id="constructions" class="section bg-light">
            <div class="container">
                <div class="text-center mb-5"><h2 class="section-title">Construction Services</h2><p class="text-muted fs-5">Build with confidence. We offer transparent, high-quality construction services.</p></div>
                <div class="card construction-table"><div class="card-header bg-primary text-white text-center py-3"><h4>üèóÔ∏è Construction Rate Chart (KDA Employees Society, Korangi)</h4></div><div class="table-responsive"><table class="table table-striped table-hover mb-0 fs-6"><thead class="table-dark"><tr><th class="py-3 px-3">Category</th><th class="py-3 px-3">Rate (PKR / Sq.Ft.)</th><th class="py-3 px-3">Details</th></tr></thead><tbody><tr><td class="py-3 px-3"><strong>Grey Structure (Labor Only)</strong></td><td class="py-3 px-3">950 ‚Äì 1,050</td><td class="py-3 px-3">Masonry, plaster, shuttering, steel fixing</td></tr><tr><td class="py-3 px-3"><strong>Grey Structure (With Material)</strong></td><td class="py-3 px-3">2,200 ‚Äì 2,500</td><td class="py-3 px-3">Complete grey structure with cement, steel, sand, crush</td></tr><tr><td class="py-3 px-3"><strong>Finishing (Basic)</strong></td><td class="py-3 px-3">1,200 ‚Äì 1,500</td><td class="py-3 px-3">Tiles, paint, woodwork, electric fittings</td></tr><tr><td class="py-3 px-3"><strong>Finishing (Premium)</strong></td><td class="py-3 px-3">2,000 ‚Äì 2,500</td><td class="py-3 px-3">Imported tiles, premium paint, wooden doors, lighting</td></tr><tr><td class="py-3 px-3"><strong>Turnkey Package (Standard)</strong></td><td class="py-3 px-3">3,500 ‚Äì 3,800</td><td class="py-3 px-3">Full construction ‚Äì grey + finishing</td></tr><tr><td class="py-3 px-3"><strong>Turnkey Package (Luxury)</strong></td><td class="py-3 px-3">4,200 ‚Äì 4,800</td><td class="py-3 px-3">Premium construction ‚Äì luxury materials & modern design</td></tr><tr><td class="py-3 px-3"><strong>Commercial Construction</strong></td><td class="py-3 px-3">5,000 ‚Äì 6,000</td><td class="py-3 px-3">Offices, shops, plazas (with high-grade material)</td></tr></tbody></table></div><div class="card-footer text-center py-3"><p class="mb-2 text-muted">Rates are estimates and may vary. Contact us for a detailed quote!</p><a href="https://wa.me/923042632003?text=I would like a detailed quote for my construction project." class="btn btn-success mt-2"><i class="fab fa-whatsapp me-2"></i>Get a Quote from Naqash (Contractor)</a></div></div>
            </div>
        </section>

        <!-- TEAM SECTION -->
        <section id="team" class="section">
            <div class="container">
                <div class="text-center mb-5"><h2 class="section-title">Meet Our Professional Team</h2><p class="text-muted fs-5">The experts dedicated to making your real estate goals a reality.</p></div>
                <div class="row g-4 justify-content-center"><div class="col-12 col-sm-6 col-lg-3"><div class="team-card"><div class="team-avatar"><i class="fas fa-user-tie"></i></div><h5>MOHSIN</h5><p class="team-role">Director</p><a href="tel:+923362842584" class="text-decoration-none text-dark">+92 336 2842584</a></div></div><div class="col-12 col-sm-6 col-lg-3"><div class="team-card"><div class="team-avatar"><i class="fas fa-user-gear"></i></div><h5>RAFIQ</h5><p class="team-role">Deputy Director</p><a href="tel:+923013313129" class="text-decoration-none text-dark">+92 301 3313129</a></div></div><div class="col-12 col-sm-6 col-lg-3"><div class="team-card"><div class="team-avatar"><i class="fas fa-bullhorn"></i></div><h5>NOMAN</h5><p class="team-role">Marketing Head</p><a href="tel:+923332491993" class="text-decoration-none text-dark">+92 333 2491993</a></div></div><div class="col-12 col-sm-6 col-lg-3"><div class="team-card"><div class="team-avatar"><i class="fas fa-hard-hat"></i></div><h5>NAQASH</h5><p class="team-role">Contractor</p<a href="tel:+923042632003" class="text-decoration-none text-dark">+92 304 2632003</a></div></div><div class="col-12 col-sm-6 col-lg-3"><div class="team-card"><div class="team-avatar"><i class="fas fa-users"></i></div><h5>WASIM</h5><p class="team-role">Coordinator</p><p class="text-muted">Ensuring smooth operations</p></div></div></div>
            </div>
        </section>

        <!-- CONTACT SECTION -->
        <section id="contact" class="section bg-light">
            <div class="container">
                <div class="text-center mb-5"><h2 class="section-title">Get In Touch</h2><p class="text-muted fs-5">We're here to help with all your property and construction needs.</p></div>
                <div class="row g-4"><div class="col-lg-7"><div class="card p-4 p-md-5 border-0 shadow-sm"><h4 class="mb-4">Send us a Message</h4><form><div class="row"><div class="col-12 col-md-6 mb-3"><label for="name" class="form-label">Full Name</label><input type="text" class="form-control" id="name" required></div><div class="col-12 col-md-6 mb-3"><label for="phone" class="form-label">Phone Number</label><input type="tel" class="form-control" id="phone" required></div></div><div class="mb-3"><label for="interest" class="form-label">I'm interested in...</label><select class="form-select" id="interest"><option>Buying a Property</option><option>Selling a Property</option><option>Renting a Property</option><option>Construction Services</option><option>General Inquiry</option></select></div><div class="mb-3"><label for="message" class="form-label">Message</label><textarea class="form-control" id="message" rows="4" required></textarea></div><button type="submit" class="btn btn-primary w-100">Send Message</button></form></div></div><div class="col-lg-5"><div class="contact-info-card h-100 d-flex flex-column justify-content-center"><h4 class="mb-4 text-white">Contact Information</h4><div class="d-flex mb-3"><i class="fas fa-map-marker-alt fa-2x me-3 mt-1" style="color: var(--secondary-color);"></i><div><h6 class="text-white">Office Address</h6><p class="mb-0">R4H6+8P7, KDA Employees Rd, Allahwala Town - Sector 31B, Korangi, Karachi</p></div></div><div class="d-flex mb-3"><i class="fas fa-phone fa-2x me-3 mt-1" style="color: var(--secondary-color);"></i><div><h6 class="text-white">Director's Phone</h6><p class="mb-0"><a href="tel:+923362842584">+92 336 2842584</a></p></div></div><div class="d-flex"><i class="fab fa-whatsapp fa-2x me-3 mt-1" style="color: var(--secondary-color);"></i><div><h6 class="text-white">WhatsApp Inquiry</h6><a href="https://wa.me/923362842584" target="_blank" class="btn btn-light btn-sm">Chat with us now</a></div></div></div></div></div>
                <div class="mt-5"><div class="card border-0 shadow-sm" style="border-radius: 15px; overflow: hidden;"><div class="card-header text-center bg-white py-3"><h5><i class="fas fa-map-marked-alt me-2 text-primary"></i>Find Our Office Location</h5></div><div class="card-body p-0"><iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3620.019939524583!2d67.1105938150029!3d24.8631779840523!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3eb33b0b0d3d5f4d%3A0x3e1f7bdf01faf4!2sKDA%20Employees%20Society!5e0!3m2!1sen!2s!4v1672522512345!5m2!1sen!2s" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div><div class="card-footer text-center py-3"><a href="https://share.google/Nm5kSRl2rlqAA7ZuF" target="_blank" class="btn btn-primary"><i class="fas fa-directions me-2"></i>Get Directions on Google Maps</a></div></div></div>
            </div>
        </section>

        <!-- Bottom Inline Ad -->
        <div class="ad-container-top-bottom">
            <script type="text/javascript"> atOptions = {'key' : 'bbb39fa2df38b4031f13f19c6a9db940', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} }; </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/bbb39fa2df38b4031f13f19c6a9db940/invoke.js"></script>
        </div>

        <!-- FOOTER -->
        <footer class="footer pt-5 pb-4">
            <div class="container">
                <div class="row"><div class="col-lg-4 col-md-6 mb-4 mb-lg-0"><h5 class="text-white mb-3"><i class="fas fa-building-user me-2"></i>MOHSIN ESTATE</h5><p class="text-muted">Your trusted partner for premium properties and construction in KDA Employment Society, Korangi.</p></div><div class="col-lg-4 col-md-6 mb-4 mb-lg-0"><h5 class="text-white mb-3">Quick Links</h5><ul class="list-unstyled footer-links"><li><a href="#home">Home</a></li><li><a href="#properties">Properties</a></li><li><a href="#constructions">Constructions</a></li><li><a href="#team">About Us</a></li><li><a href="#contact">Contact</a></li></ul></div><div class="col-lg-4 col-md-12"><h5 class="text-white mb-3">Contact Info</h5><p class="text-muted mb-2"><i class="fas fa-map-marker-alt me-2"></i>KDA Employees Society, Korangi, Karachi</p><p class="text-muted mb-2"><i class="fas fa-phone me-2"></i><a href="tel:+923362842584" class="text-muted text-decoration-none">+92 336 2842584</a></p><a href="https://wa.me/923362842584" class="btn btn-success btn-sm" target="_blank"><i class="fab fa-whatsapp me-1"></i>WhatsApp Us</a></div></div>
                <hr class="my-4" style="border-color: rgba(255,255,255,0.2);"><div class="text-center"><p class="text-muted mb-0">&copy; 2024 MOHSIN ESTATE. All Rights Reserved.</p><a href="javascript:void(0);" onclick="showAdminPanel()" style="font-size: 0.8rem; text-decoration: none; color: #d4af37; font-weight: 500;">Admin Login</a></div>
            </div>
        </footer>

        <!-- Property Details Modal (Remains for potential future use) -->
        <div class="modal fade" id="propertyDetailsModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="modal-property-title"></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div id="propertyCarousel" class="carousel slide mb-4" data-bs-ride="carousel">
                  <div class="carousel-inner" id="carousel-images-container"></div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#propertyCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
                  <button class="carousel-control-next" type="button" data-bs-target="#propertyCarousel" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
                </div>
                <div id="video-container" class="mb-4 text-center" style="display: none;"><video id="property-video-player" controls></video></div>
                <h4 class="property-price" id="modal-property-price"></h4>
                <p class="text-muted fs-5"><i class="fas fa-map-marker-alt me-2"></i><span id="modal-property-location"></span></p>
                <div class="modal-property-info">
                    <div><i class="fas fa-bed fa-2x text-primary"></i><p class="mb-0 mt-1"><span id="modal-property-beds"></span> Beds</p></div>
                    <div><i class="fas fa-bath fa-2x text-primary"></i><p class="mb-0 mt-1"><span id="modal-property-baths"></span> Baths</p></div>
                    <div><i class="fas fa-ruler-combined fa-2x text-primary"></i><p class="mb-0 mt-1"><span id="modal-property-area"></span> Sq.Yd.</p></div>
                </div>
              </div>
              <div class="modal-footer justify-content-center">
                <a href="" id="modal-contact-btn" class="btn btn-success w-50"><i class="fab fa-whatsapp me-2"></i>Contact on WhatsApp</a>
              </div>
            </div>
          </div>
        </div>
    </div>

    <!-- Admin Panel Wrapper (Initially Hidden) -->
    <div id="admin-wrapper" style="display: none;">
        <!-- Initial View -->
        <div id="initial-view">
            <div class="container">
                <h1 class="display-4 mb-4"><i class="fas fa-building-user me-2"></i>Welcome to MOHSIN ESTATE</h1>
                <p class="lead mb-5">Please select your portal to continue.</p>
                <div>
                    <button id="show-user-portal" class="btn btn-primary btn-portal"><i class="fas fa-user-plus me-2"></i>Add/Manage Property</button>
                    <button id="show-admin-portal" class="btn btn-dark btn-portal"><i class="fas fa-shield-halved me-2"></i>Admin Panel</button>
                </div>
            </div>
        </div>

        <!-- User Portal -->
        <div id="user-portal-container" style="display: none;">
            <nav class="navbar navbar-dark bg-dark"><div class="container"><a class="navbar-brand" href="javascript:void(0);" onclick="showMainView()"><i class="fas fa-building-user me-2"></i>MOHSIN ESTATE - User Portal</a><button id="logout-btn" class="btn btn-outline-warning d-none"><i class="fas fa-sign-out-alt me-2"></i>Logout</button></div></nav>
            <div id="login-view" class="container" style="max-width: 400px; margin: 5rem auto;"><div class="card shadow-sm"><div class="card-header bg-primary text-white text-center"><h4><i class="fas fa-mobile-alt me-2"></i>Create Account / Login</h4></div><div class="card-body p-4"><p class="text-center text-muted">Enter your mobile number to manage your property listings.</p><form id="user-login-form"><div class="mb-3"><label for="mobileNumber" class="form-label">Mobile Number</label><input type="tel" class="form-control" id="mobileNumber" placeholder="e.g., 03331234567" required></div><button type="submit" class="btn btn-primary w-100">Continue</button></form></div></div></div>
            <div id="main-content" class="container mt-5 d-none"><div class="row"><div class="col-lg-5"><div class="card shadow-sm"><div class="card-header bg-primary text-white"><h4 id="form-title"><i class="fas fa-plus-circle me-2"></i>Add New Property</h4></div><div class="card-body"><form id="user-property-form"><input type="hidden" id="propertyId"><div class="mb-3"><label for="userPropertyTitle" class="form-label">Property Title</label><input type="text" class="form-control" id="userPropertyTitle" required></div><div class="mb-3"><label for="userPropertyLocation" class="form-label">Location</label><input type="text" class="form-control" id="userPropertyLocation" required></div><div class="mb-3"><label for="userPropertyStatus" class="form-label">Status</label><select class="form-select" id="userPropertyStatus"><option value="For Sale">For Sale</option><option value="For Rent">For Rent</option></select></div><div class="row"><div class="col-md-4 mb-3"><label for="userPropertyBeds" class="form-label">Beds</label><input type="number" class="form-control" id="userPropertyBeds" required></div><div class="col-md-4 mb-3"><label for="userPropertyBaths" class="form-label">Baths</label><input type="number" class="form-control" id="userPropertyBaths" required></div><div class="col-md-4 mb-3"><label for="userPropertyArea" class="form-label">Area (Sq.Yd.)</label><input type="text" class="form-control" id="userPropertyArea" required></div></div><div class="mb-3"><label for="userPropertyPrice" class="form-label">Price / Rent</label><input type="text" class="form-control" id="userPropertyPrice" required></div><div class="mb-3"><label for="userPropertyImages" class="form-label">Upload Images</label><div class="input-group"><input type="file" class="form-control" id="userPropertyImages" accept="image/*" multiple><button class="btn btn-outline-secondary" type="button" id="addUserImageBtn" title="Add More Images"><i class="fas fa-plus"></i></button></div><div id="user-image-preview" class="image-preview-container"></div></div><div class="mb-3"><label for="userPropertyVideo" class="form-label">Upload Video (Optional)</label><input type="file" class="form-control" id="userPropertyVideo" accept="video/*"><div id="user-video-preview"></div></div><button type="submit" class="btn btn-primary w-100"><i class="fas fa-save me-2"></i>Save Property</button><button type="button" id="cancel-edit-btn" class="btn btn-secondary w-100 mt-2 d-none">Cancel Edit</button></form></div></div></div><div class="col-lg-7"><div class="card shadow-sm"><div class="card-header"><h4><i class="fas fa-list-alt me-2"></i>Your Property Listings</h4></div><div class="card-body"><div id="user-property-list" class="list-group"></div></div><div class="card-footer bg-light text-end"><button id="delete-account-btn" class="btn btn-danger"><i class="fas fa-user-slash me-2"></i>Delete My Account</button></div></div></div></div></div>
        </div>
        
        <!-- Admin Portal -->
        <div id="admin-portal-container" style="display: none;">
            <div id="admin-login-container" style="min-height: 100vh; display: flex; align-items: center; justify-content: center;"><div class="col-md-4"><div class="card shadow-sm"><div class="card-header bg-dark text-white text-center"><div class="d-flex justify-content-between align-items-center"><button class="btn btn-sm btn-outline-light" onclick="showMainView()"><i class="fas fa-arrow-left"></i></button><h4 class="mb-0 flex-grow-1"><i class="fas fa-shield-halved me-2"></i>MOHSIN ESTATE</h4></div><small>Admin Panel Login</small></div><div class="card-body"><form id="admin-login-form"><div class="mb-3"><label for="username" class="form-label"><i class="fas fa-user me-2"></i>Username</label><input type="text" class="form-control" id="username" value="admin" required></div><div class="mb-3"><label for="password" class="form-label"><i class="fas fa-lock me-2"></i>Password</label><input type="password" class="form-control" id="password" value="mohsin@123" required></div><button type="submit" class="btn btn-primary w-100"><i class="fas fa-sign-in-alt me-2"></i>Login</button></form><div id="login-error" class="text-danger mt-3 text-center"></div></div></div></div></div>
            <div id="admin-panel" style="display: none;"><nav class="navbar navbar-dark bg-dark"><div class="container"><a class="navbar-brand" href="javascript:void(0);" onclick="showMainView()"><i class="fas fa-shield-halved me-2"></i>MOHSIN ESTATE - Admin Panel</a></div></nav><div class="container mt-4"><ul class="nav nav-tabs" id="adminTab" role="tablist"><li class="nav-item" role="presentation"><button class="nav-link active" id="add-property-tab" data-bs-toggle="tab" data-bs-target="#add-property" type="button"><i class="fas fa-plus-circle me-2"></i>Admin Posts</button></li><li class="nav-item" role="presentation"><button class="nav-link" id="check-user-tab" data-bs-toggle="tab" data-bs-target="#check-user" type="button"><i class="fas fa-users-cog me-2"></i>Check User Posts</button></li></ul><div class="tab-content" id="adminTabContent"><div class="tab-pane fade show active" id="add-property" role="tabpanel"><div class="row mt-4"><div class="col-lg-5"><div class="card shadow-sm"><div class="card-header bg-primary text-white"><h4><i class="fas fa-plus-circle me-2"></i>Add New Property (Admin)</h4></div><div class="card-body"><form id="admin-property-form"><div class="mb-3"><label for="adminPropertyTitle" class="form-label">Property Title</label><input type="text" class="form-control" id="adminPropertyTitle" required></div><div class="mb-3"><label for="adminPropertyLocation" class="form-label">Location</label><input type="text" class="form-control" id="adminPropertyLocation" required></div><div class="mb-3"><label for="adminPropertyStatus" class="form-label">Status</label><select class="form-select" id="adminPropertyStatus"><option value="For Sale">For Sale</option><option value="For Rent">For Rent</option></select></div><div class="row"><div class="col-md-4 mb-3"><label for="adminPropertyBeds" class="form-label">Beds</label><input type="number" class="form-control" id="adminPropertyBeds" required></div><div class="col-md-4 mb-3"><label for="adminPropertyBaths" class="form-label">Baths</label><input type="number" class="form-control" id="adminPropertyBaths" required></div><div class="col-md-4 mb-3"><label for="adminPropertyArea" class="form-label">Area (Sq.Yd.)</label><input type="text" class="form-control" id="adminPropertyArea" required></div></div><div class="mb-3"><label for="adminPropertyPrice" class="form-label">Price / Rent</label><input type="text" class="form-control" id="adminPropertyPrice" required></div><div class="mb-3"><label for="adminPropertyImages" class="form-label">Upload Images</label><div class="input-group"><input type="file" class="form-control" id="adminPropertyImages" accept="image/*" multiple required><button class="btn btn-outline-secondary" type="button" id="addAdminImageBtn" title="Add More Images"><i class="fas fa-plus"></i></button></div><div id="admin-image-preview" class="image-preview-container"></div></div><div class="mb-3"><label for="adminPropertyVideo" class="form-label">Upload Video (Optional)</label><input type="file" class="form-control" id="adminPropertyVideo" accept="video/*"><div id="admin-video-preview"></div></div><button type="submit" class="btn btn-primary w-100"><i class="fas fa-save me-2"></i>Save Property</button></form></div></div></div><div class="col-lg-7"><div class="card shadow-sm"><div class="card-header"><h4><i class="fas fa-list-alt me-2"></i>Current Admin Listings</h4></div><div class="card-body"><div id="admin-property-list" class="list-group"></div></div></div></div></div></div><div class="tab-pane fade" id="check-user" role="tabpanel"><div class="card shadow-sm mt-4"><div class="card-header bg-secondary text-white"><h4><i class="fas fa-tasks me-2"></i>Manage All User Properties</h4></div><div class="card-body"><div id="all-property-list" class="list-group"></div></div></div></div></div></div></div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() { if (!sessionStorage.getItem('adShown')) { const showAdOnClick = () => { sessionStorage.setItem('adShown', 'true'); const adScript = document.createElement('script'); adScript.type = 'text/javascript'; adScript.src = '//pl27400430.profitableratecpm.com/be/2e/06/be2e06ec9e2276671d155fc84fcfca02.js'; document.body.appendChild(adScript); document.body.removeEventListener('click', showAdOnClick); }; document.body.addEventListener('click', showAdOnClick); } });
    </script>
    
    <script>
        // --- View Wrappers ---
        const mainViewWrapper = document.getElementById('main-view-wrapper');
        const adminWrapper = document.getElementById('admin-wrapper');
        
        // --- IndexedDB Helper (Combined) ---
        const propertyDB = {
            db: null,
            init: function() {
                return new Promise((resolve, reject) => {
                    if (this.db) return resolve();
                    const request = indexedDB.open('mohsinEstateDB', 1);
                    request.onerror = (e) => reject("DB Error: " + e.target.errorCode);
                    request.onsuccess = (e) => { this.db = e.target.result; resolve(); };
                    request.onupgradeneeded = (e) => {
                        const db = e.target.result;
                        if (!db.objectStoreNames.contains('properties')) {
                            db.createObjectStore('properties', { keyPath: 'id' });
                        }
                    };
                });
            },
            async getAll() {
                await this.init();
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction('properties', 'readonly');
                    const store = transaction.objectStore('properties');
                    const request = store.getAll();
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = (e) => reject(e.target.error);
                });
            },
            async put(property) {
                await this.init();
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction('properties', 'readwrite');
                    const store = transaction.objectStore('properties');
                    const request = store.put(property);
                    request.onsuccess = () => resolve();
                    request.onerror = (e) => reject(e.target.error);
                });
            },
            async delete(id) {
                await this.init();
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction('properties', 'readwrite');
                    const store = transaction.objectStore('properties');
                    const request = store.delete(id);
                    request.onsuccess = () => resolve();
                    request.onerror = (e) => reject(e.target.error);
                });
            }
        };

        // --- Global Helper Functions ---
        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        window.deleteProperty = async function(id) {
            if (confirm('Are you sure you want to permanently delete this property?')) {
                await propertyDB.delete(id);
                if (document.getElementById('admin-portal-container').style.display !== 'none') { await loadAdminProperties(); await loadAllProperties(); }
                if (document.getElementById('user-portal-container').style.display !== 'none') { await loadUserProperties(); }
            }
        }

        // --- View Navigation & Refresh Logic (MODIFIED) ---
        const initialView = document.getElementById('initial-view');
        const userPortal = document.getElementById('user-portal-container');
        const adminPortal = document.getElementById('admin-portal-container');
        
        function showAdminPanel() {
            mainViewWrapper.style.display = 'none';
            adminWrapper.style.display = 'block';
            window.scrollTo(0, 0);
        }

        function showMainView() {
            adminWrapper.style.display = 'none';
            mainViewWrapper.style.display = 'block';
            
            // Refresh properties on the main page
            renderProperties();
            
            // Reset admin panel state for next time
            initialView.style.display = 'flex';
            userPortal.style.display = 'none';
            adminPortal.style.display = 'none';
            document.getElementById('admin-login-container').style.display = 'flex';
            document.getElementById('admin-panel').style.display = 'none';
            window.scrollTo(0, 0);
        }

        // --- Combined DOMContentLoaded Event Listener ---
        document.addEventListener('DOMContentLoaded', function() {
            
            // === Main Page (index.html) Logic ===
            const propertyListingsContainer = document.getElementById('property-listings');
            let propertyDetailsModal; // Kept for potential future use

            const renderProperties = async () => {
                const properties = await propertyDB.getAll();
                properties.sort((a, b) => b.id - a.id); // Show latest first

                if (!properties || properties.length === 0) {
                    propertyListingsContainer.innerHTML = '<p class="text-center text-muted col-12">No properties are currently listed. Please check back later or add one!</p>';
                } else {
                    propertyListingsContainer.innerHTML = '';
                    properties.forEach(property => {
                        const isForRent = property.status === 'For Rent';
                        const badgeColor = isForRent ? '#28a745' : '#0a2d4d';
                        const priceText = isForRent ? `${property.price} / month` : property.price;
                        let mediaHTML = '';
                        const carouselId = `carousel-${property.id}`;
                        if (property.images && property.images.length > 0) {
                            const carouselItems = property.images.map((img, index) => `<div class="carousel-item ${index === 0 ? 'active' : ''}"><img src="${img}" class="d-block w-100 card-carousel-item" alt="Property Image ${index + 1}" loading="lazy"></div>`).join('');
                            mediaHTML += `<div id="${carouselId}" class="carousel slide" data-bs-ride="carousel"><div class="carousel-inner">${carouselItems}</div><button class="carousel-control-prev" type="button" data-bs-target="#${carouselId}" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span><span class="visually-hidden">Previous</span></button><button class="carousel-control-next" type="button" data-bs-target="#${carouselId}" data-bs-slide="next"><span class="carousel-control-next-icon"></span><span class="visually-hidden">Next</span></button></div>`;
                        } else {
                            mediaHTML += `<img src="https://via.placeholder.com/400x250" alt="${property.title}" class="img-fluid" loading="lazy">`;
                        }
                        if (property.video) {
                            mediaHTML += `<video class="card-video" src="${property.video}" muted controls loop playsinline></video>`;
                        }
                        const cardHTML = `<div class="col-12 col-md-6 col-lg-4"><div class="property-card h-100 d-flex flex-column"><div class="property-media-container">${mediaHTML}<div class="property-badge" style="background-color: ${badgeColor};">${property.status}</div></div><div class="property-content d-flex flex-column flex-grow-1"><h5>${property.title}</h5><p class="text-muted"><i class="fas fa-map-marker-alt me-2"></i>${property.location}</p><div class="d-flex justify-content-between text-muted my-3"><span><i class="fas fa-bed me-1"></i> ${property.beds} Beds</span><span><i class="fas fa-bath me-1"></i> ${property.baths} Baths</span><span><i class="fas fa-ruler-combined me-1"></i> ${property.area} Sq.Yd.</span></div><div class="property-price mt-auto">${priceText}</div><div class="d-grid mt-3"><a href="https://wa.me/923362842584?text=I'm interested in the property: ${encodeURIComponent(property.title)}" class="btn btn-success"><i class="fab fa-whatsapp me-2"></i>Contact Now</a></div></div></div></div>`;
                        propertyListingsContainer.innerHTML += cardHTML;
                    });
                }
            };
            
            window.showPropertyDetails = async function(id) {
                const properties = await propertyDB.getAll();
                const property = properties.find(p => p.id === id);
                if (!property) return;
                document.getElementById('modal-property-title').textContent = property.title;
                document.getElementById('modal-property-location').textContent = property.location;
                document.getElementById('modal-property-price').textContent = property.status === 'For Rent' ? `${property.price} / month` : property.price;
                document.getElementById('modal-property-beds').textContent = property.beds;
                document.getElementById('modal-property-baths').textContent = property.baths;
                document.getElementById('modal-property-area').textContent = property.area;
                document.getElementById('modal-contact-btn').href = `https://wa.me/923362842584?text=I'm interested in the property: ${encodeURIComponent(property.title)}`;
                const carouselContainer = document.getElementById('carousel-images-container');
                carouselContainer.innerHTML = '';
                if (property.images && property.images.length > 0) {
                    property.images.forEach((img, index) => { carouselContainer.innerHTML += `<div class="carousel-item ${index === 0 ? 'active' : ''}"><img src="${img}" class="d-block w-100 modal-carousel-item" alt="Property Image"></div>`; });
                    document.getElementById('propertyCarousel').style.display = 'block';
                } else { document.getElementById('propertyCarousel').style.display = 'none'; }
                const videoContainer = document.getElementById('video-container');
                const videoPlayer = document.getElementById('property-video-player');
                if (property.video) { videoPlayer.src = property.video; videoContainer.style.display = 'block'; }
                else { videoPlayer.src = ''; videoContainer.style.display = 'none'; }
                if (!propertyDetailsModal) { propertyDetailsModal = new bootstrap.Modal(document.getElementById('propertyDetailsModal')); }
                propertyDetailsModal.show();
            };

            propertyListingsContainer.addEventListener('click', function(e) {
                const viewButton = e.target.closest('.view-details-btn');
                if (viewButton) { const propertyId = parseInt(viewButton.dataset.id, 10); showPropertyDetails(propertyId); }
            });
            
            // Make renderProperties globally accessible for the back button
            window.renderProperties = renderProperties;
            // Initial load of properties on the main page
            renderProperties();

            // === Admin Panel (admin.html) Logic ===
            document.getElementById('show-user-portal').addEventListener('click', () => { initialView.style.display = 'none'; userPortal.style.display = 'block'; adminPortal.style.display = 'none'; });
            document.getElementById('show-admin-portal').addEventListener('click', () => { initialView.style.display = 'none'; userPortal.style.display = 'none'; adminPortal.style.display = 'block'; });

            function setupImageUploader(fileInputId, addBtnId, previewContainerId) { let stagedFiles = []; const fileInput = document.getElementById(fileInputId); const addBtn = document.getElementById(addBtnId); const previewContainer = document.getElementById(previewContainerId); const renderPreviews = () => { previewContainer.innerHTML = ''; stagedFiles.forEach((file, index) => { const reader = new FileReader(); reader.onload = (e) => { const wrapper = document.createElement('div'); wrapper.className = 'preview-image-wrapper'; wrapper.innerHTML = `<img src="${e.target.result}" class="preview-image"><button type="button" class="remove-image-btn" data-index="${index}">&times;</button>`; previewContainer.appendChild(wrapper); }; reader.readAsDataURL(file); }); }; const handleFiles = (files) => { stagedFiles.push(...Array.from(files)); renderPreviews(); fileInput.value = ''; }; fileInput.addEventListener('change', (e) => handleFiles(e.target.files)); addBtn.addEventListener('click', () => fileInput.click()); previewContainer.addEventListener('click', (e) => { if (e.target.classList.contains('remove-image-btn')) { const index = parseInt(e.target.dataset.index, 10); stagedFiles.splice(index, 1); renderPreviews(); } }); return { getFiles: () => stagedFiles, clear: () => { stagedFiles = []; renderPreviews(); } }; }
            function setupVideoPreview(videoId, previewContainerId){ const videoInput = document.getElementById(videoId); const previewContainer = document.getElementById(previewContainerId); videoInput.addEventListener('change', () => { previewContainer.innerHTML = ''; const file = videoInput.files[0]; if (file) { const reader = new FileReader(); reader.onload = e => previewContainer.innerHTML = `<video src="${e.target.result}" class="preview-video" controls></video>`; reader.readAsDataURL(file); } }); }

            // -- User Portal Logic --
            const loginView = document.getElementById('login-view'), mainContentView = document.getElementById('main-content'); const userLoginForm = document.getElementById('user-login-form'), logoutBtn = document.getElementById('logout-btn'); const userPropertyForm = document.getElementById('user-property-form'), userPropertyList = document.getElementById('user-property-list'); const cancelEditBtn = document.getElementById('cancel-edit-btn'), formTitle = document.getElementById('form-title'); const deleteAccountBtn = document.getElementById('delete-account-btn'); let currentUser = sessionStorage.getItem('currentUser'); const userImageUploader = setupImageUploader('userPropertyImages', 'addUserImageBtn', 'user-image-preview'); setupVideoPreview('userPropertyVideo', 'user-video-preview');
            if (currentUser) showMainContent(); else showLoginView();
            userLoginForm.addEventListener('submit', e => { e.preventDefault(); const mobile = document.getElementById('mobileNumber').value; if(mobile){ sessionStorage.setItem('currentUser', mobile); currentUser = mobile; showMainContent(); } });
            logoutBtn.addEventListener('click', () => { sessionStorage.removeItem('currentUser'); currentUser = null; showLoginView(); });
            deleteAccountBtn.addEventListener('click', async () => { if (confirm('Are you sure? This will delete your account and all listings.')) { let all = await propertyDB.getAll(); for(const prop of all.filter(p=>p.userId === currentUser)) { await propertyDB.delete(prop.id); } sessionStorage.removeItem('currentUser'); currentUser = null; alert('Account deleted.'); showLoginView(); } });
            function showLoginView() { loginView.classList.remove('d-none'); mainContentView.classList.add('d-none'); logoutBtn.classList.add('d-none'); }
            async function showMainContent() { loginView.classList.add('d-none'); mainContentView.classList.remove('d-none'); logoutBtn.classList.remove('d-none'); await loadUserProperties(); }
            userPropertyForm.addEventListener('submit', async function(e) { e.preventDefault(); const propertyId = document.getElementById('propertyId').value; const imageFiles = userImageUploader.getFiles(); const videoFile = document.getElementById('userPropertyVideo').files[0]; if (!propertyId && imageFiles.length === 0) { alert('At least one image is required for a new property.'); return; } const imagePromises = imageFiles.map(file => toBase64(file)); const videoPromise = videoFile ? toBase64(videoFile) : Promise.resolve(null); const [imagesBase64, videoBase64] = await Promise.all([Promise.all(imagePromises), videoPromise]); let property; if (propertyId) { const allProperties = await propertyDB.getAll(); property = allProperties.find(p => p.id == propertyId); if(!property) return; updatePropertyData(property); if(imagesBase64.length > 0) property.images = imagesBase64; if(videoFile) property.video = videoBase64; } else { property = { id: Date.now(), userId: currentUser }; updatePropertyData(property); property.images = imagesBase64; property.video = videoBase64; } await propertyDB.put(property); resetUserForm(); await loadUserProperties(); });
            function updatePropertyData(p) { p.title = document.getElementById('userPropertyTitle').value; p.location = document.getElementById('userPropertyLocation').value; p.status = document.getElementById('userPropertyStatus').value; p.beds = document.getElementById('userPropertyBeds').value; p.baths = document.getElementById('userPropertyBaths').value; p.area = document.getElementById('userPropertyArea').value; p.price = document.getElementById('userPropertyPrice').value; }
            window.loadUserProperties = async function() { const all = await propertyDB.getAll(); const userProperties = all.filter(p => p.userId === currentUser); userPropertyList.innerHTML = userProperties.length === 0 ? '<p class="text-center text-muted">You have not added any properties yet.</p>' : ''; userProperties.forEach(p => { const item = document.createElement('div'); item.className = 'list-group-item d-flex justify-content-between align-items-center'; const mainImg = (p.images && p.images.length > 0) ? p.images[0] : 'https://via.placeholder.com/50'; item.innerHTML = `<span class="d-flex align-items-center"><img src="${mainImg}" width="50" height="50" class="me-3 rounded" style="object-fit: cover;"><div><strong>${p.title}</strong><br><small class="text-muted">${p.location}</small></div></span><span><button class="btn btn-outline-primary btn-sm me-2" onclick="editProperty(${p.id})"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger btn-sm" onclick="deleteProperty(${p.id})"><i class="fas fa-trash-alt"></i></button></span>`; userPropertyList.appendChild(item); }); }
            window.editProperty = async function(id) { const all = await propertyDB.getAll(); const p = all.find(p => p.id === id); if (p) { formTitle.innerHTML = '<i class="fas fa-edit me-2"></i>Edit Property'; Object.keys(p).forEach(key => { const el = document.getElementById('userProperty' + key.charAt(0).toUpperCase() + key.slice(1)); if(el) el.value = p[key]; }); document.getElementById('propertyId').value = p.id; cancelEditBtn.classList.remove('d-none'); resetUserFormMedia(); window.scrollTo(0, 0); } }
            function resetUserFormMedia() { userImageUploader.clear(); document.getElementById('userPropertyVideo').value = ''; document.getElementById('user-video-preview').innerHTML = ''; }
            function resetUserForm() { userPropertyForm.reset(); document.getElementById('propertyId').value = ''; resetUserFormMedia(); formTitle.innerHTML = '<i class="fas fa-plus-circle me-2"></i>Add New Property'; cancelEditBtn.classList.add('d-none'); }
            cancelEditBtn.addEventListener('click', resetUserForm);

            // -- Admin Portal Logic --
            const adminLoginForm = document.getElementById('admin-login-form'), adminLoginContainer = document.getElementById('admin-login-container'); const adminPanel = document.getElementById('admin-panel'), loginError = document.getElementById('login-error'); const adminPropertyForm = document.getElementById('admin-property-form'), adminPropertyList = document.getElementById('admin-property-list'); const allPropertyList = document.getElementById('all-property-list'), userCheckTab = document.getElementById('check-user-tab'); const adminImageUploader = setupImageUploader('adminPropertyImages', 'addAdminImageBtn', 'admin-image-preview'); setupVideoPreview('adminPropertyVideo', 'admin-video-preview');
            adminLoginForm.addEventListener('submit', async (e) => { e.preventDefault(); if (document.getElementById('username').value === 'admin' && document.getElementById('password').value === 'mohsin@123') { adminLoginContainer.style.display = 'none'; adminPanel.style.display = 'block'; await loadAdminProperties(); } else { loginError.textContent = 'Invalid username or password.'; }});
            adminPropertyForm.addEventListener('submit', async function(e) { e.preventDefault(); const imageFiles = adminImageUploader.getFiles(); if (imageFiles.length === 0) { alert('At least one image is required.'); return; } const videoFile = document.getElementById('adminPropertyVideo').files[0]; const [imagesBase64, videoBase64] = await Promise.all([Promise.all(imageFiles.map(toBase64)), videoFile ? toBase64(videoFile) : null]); const property = { id: Date.now(), userId: 'admin', images: imagesBase64, video: videoBase64, title: document.getElementById('adminPropertyTitle').value, location: document.getElementById('adminPropertyLocation').value, status: document.getElementById('adminPropertyStatus').value, beds: document.getElementById('adminPropertyBeds').value, baths: document.getElementById('adminPropertyBaths').value, area: document.getElementById('adminPropertyArea').value, price: document.getElementById('adminPropertyPrice').value }; await propertyDB.put(property); adminPropertyForm.reset(); adminImageUploader.clear(); document.getElementById('admin-video-preview').innerHTML = ''; await loadAdminProperties(); if (document.querySelector('#check-user.active')) await loadAllProperties(); });
            window.loadAdminProperties = async function() { const all = await propertyDB.getAll(); const properties = all.filter(p => p.userId === 'admin'); adminPropertyList.innerHTML = properties.length === 0 ? '<p class="text-center text-muted">No admin properties have been added yet.</p>' : ''; properties.forEach(p => { const item = document.createElement('div'); const mainImg = (p.images && p.images.length > 0) ? p.images[0] : 'https://via.placeholder.com/50'; item.className = 'list-group-item d-flex justify-content-between align-items-center'; item.innerHTML = `<span><img src="${mainImg}" width="50" height="50" class="me-3 rounded" style="object-fit: cover;"><strong>${p.title}</strong> - ${p.location}</span><button class="btn btn-danger btn-sm" onclick="deleteProperty(${p.id})"><i class="fas fa-trash-alt"></i></button>`; adminPropertyList.appendChild(item); }); }
            window.loadAllProperties = async function() { const properties = await propertyDB.getAll(); allPropertyList.innerHTML = properties.length === 0 ? '<p class="text-center text-muted">No properties exist yet.</p>' : ''; properties.forEach(p => { const userBadge = p.userId === 'admin' ? `<span class="badge bg-primary">Admin</span>` : `<span class="badge bg-info text-dark">User: ${p.userId}</span>`; const mainImg = (p.images && p.images.length > 0) ? p.images[0] : 'https://via.placeholder.com/50'; const item = document.createElement('div'); item.className = 'list-group-item d-flex justify-content-between align-items-center'; item.innerHTML = `<div class="d-flex align-items-center"><img src="${mainImg}" width="50" height="50" class="me-3 rounded" style="object-fit: cover;"><div><strong>${p.title}</strong><br><small class="text-muted">${p.location}</small></div></div><div class="d-flex align-items-center"><div class="me-3 text-end">${userBadge}</div><button class="btn btn-danger btn-sm" onclick="deleteProperty(${p.id})"><i class="fas fa-trash-alt me-1"></i> Delete</button></div>`; allPropertyList.appendChild(item); }); }
            userCheckTab.addEventListener('shown.bs.tab', loadAllProperties);
        });
    </script>

</body>
</html>